<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/x-icon" href="./assets/svg/logo-escudo.svg" />
  <title>Dashboard - Data Sentry</title>
  <link rel="stylesheet" href="./css/navbarLateral.css" />
  <link rel="stylesheet" href="./css/dashboard.css" />
  <!-- IMPORTAÇÃO PARA DONWLOAD EXCEL -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"
    integrity="sha512-jDEmOIskGs/j5S3wBWQAL4pOYy3S5a0y3Vav7BgXHnCVcUBXkf1OqzYS6njmDiKyqes22QEX8GSIZZ5pGk+9nA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
  <!---JIVOCHAT---->
  <script src="//code.jivosite.com/widget/K7RJgm8xzE" async></script>

  <!---Chart JS minificado---->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"
    integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!---Plugin Annotation---->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/2.0.1/chartjs-plugin-annotation.min.js"
    integrity="sha512-LZEOcU8s74hwWva82MJux7GgFNjfeExXG9yZPQrKz567Od4O2D/6UX3oGoZiRDOdbMtH33NBq7vonH4VOUPA/Q=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="./js/validacaoLogin.js"></script>
  <script src="./js/jwt.js"></script>
</head>

<body>
  <!-- Loading -->
  <div id="div_loading">
    <div class="loader">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <!-- Navbar Lateral -->
  <div class="navbar">
    <div class="navbar_container">
      <div class="navbar_topo">
        <img id="logo_navbar" src="./assets/svg/logo-escudo.svg" />
        <a href="./perfil.html">
          <div class="tooltip">
            <svg viewBox="0 0 24 24" fill="white">
              <path
                d="M7.5 6.5C7.5 8.981 9.519 11 12 11s4.5-2.019 4.5-4.5S14.481 2 12 2S7.5 4.019 7.5 6.5zM20 21h1v-1c0-3.859-3.141-7-7-7h-4c-3.86 0-7 3.141-7 7v1h17z">
              </path>
            </svg>
            <span class="tooltiptext">Perfil</span>
          </div>
        </a>

        <a href="./dashboard.html">
          <div class="tooltip">
            <svg viewBox="0 0 36 36" fill="#15CDD3">
              <path
                d="M18 4.25A16.49 16.49 0 0 0 5.4 31.4l.3.35h24.6l.3-.35A16.49 16.49 0 0 0 18 4.25Zm8.6 9.48l-5.92 5.81a3 3 0 1 1-1.41-1.42l5.91-5.81Zm-23 6.17H7v2H3.56c0-.39-.05-.77-.05-1.17s.02-.55.04-.83Zm4.88-10l2.46 2.46l-1.47 1.38L7 11.29a14.57 14.57 0 0 1 1.43-1.42ZM19 9.79h-2v-3.5h1c.37 0 .7 0 1 .05Zm13.49 10.95c0 .39 0 .79-.05 1.17h-3.52v-2h3.53c.02.27.04.55.04.83Z">
              </path>
            </svg>
            <span class="tooltiptext">Dashboard</span>
          </div>
        </a>

        <a href="./usuarios.html">
          <div class="tooltip">
            <svg viewBox="0 0 24 24" fill="white">
              <path
                d="M9 11a4 4 0 1 0-4-4a4 4 0 0 0 4 4Zm8 2a3 3 0 1 0-3-3a3 3 0 0 0 3 3Zm4 7a1 1 0 0 0 1-1a5 5 0 0 0-8.06-3.95A7 7 0 0 0 2 20a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1">
              </path>
            </svg>
            <span class="tooltiptext">Usuários</span>
          </div>
        </a>

        <a href="./gerenciar_servidores.html">
          <div class="tooltip">
            <svg viewBox="0 0 24 24" fill="white">
              <path
                d="M5.507 4.048A3 3 0 0 1 7.785 3h8.43a3 3 0 0 1 2.278 1.048l1.722 2.008A4.533 4.533 0 0 0 19.5 6h-15c-.243 0-.482.02-.715.056l1.722-2.008Z" />
              <path fill-rule="evenodd"
                d="M1.5 10.5a3 3 0 0 1 3-3h15a3 3 0 1 1 0 6h-15a3 3 0 0 1-3-3Zm15 0a.75.75 0 1 1-1.5 0a.75.75 0 0 1 1.5 0Zm2.25.75a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5ZM4.5 15a3 3 0 1 0 0 6h15a3 3 0 1 0 0-6h-15Zm11.25 3.75a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5ZM19.5 18a.75.75 0 1 1-1.5 0a.75.75 0 0 1 1.5 0Z">
              </path>
            </svg>
            <span class="tooltiptext">Servidores</span>
          </div>
        </a>
      </div>

      <div class="navbar_base">
        <a onclick="logout()" class="tooltip">
          <svg viewBox="0 0 24 24" fill="white">
            <path
              d="M5 21q-.825 0-1.413-.587Q3 19.825 3 19V5q0-.825.587-1.413Q4.175 3 5 3h7v2H5v14h7v2Zm11-4l-1.375-1.45l2.55-2.55H9v-2h8.175l-2.55-2.55L16 7l5 5Z">
            </path>
          </svg>
          <span class="tooltiptext">Sair</span>
        </a>
      </div>
    </div>
  </div>

  <!-- Tela sem graficos ou KPIs (sem servidores registrados) -->
  <div id="tela_sem_servidores">
    <div id="notfound">
      <div class="notfound">
        <div class="notfound-404">
          <h1>:(</h1>
        </div>
        <h2>Oops... Nada de dashboard</h2>
        <p>
          Parece que você não possui servidores cadastrados para serem
          analisados.
        </p>
        <p>
          Tente recarregar a página ou vá para a tela de gerenciamento de
          servidores.
        </p>
        <a href="./gerenciar_servidores.html">Servidores</a><a id="a2" onclick="window.location.reload();"><svg
            width="19px" height="19px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path id="svg_refresh" fill="none" stroke="#292929" stroke-width="2"
              d="M20,8 C18.5974037,5.04031171 15.536972,3 12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 L12,21 C16.9705627,21 21,16.9705627 21,12 M21,3 L21,9 L15,9" />
          </svg></a>
      </div>
    </div>
  </div>

  <!-- Conteúdo dashboards -->
  <div id="tela_completa_dashboard" class="body_container">
    <div class="bloco1">
      <p id="nomeClinica">Clínica Cirúrgica Santa Efigênia</p>
      <button id="botao_excel" onclick="getExcel()">Exportar Excel do último dia</button>
      <div class="dropdown">
        <button onclick="myFunction()" id="btn_drop" class="dropbtn"></button>
        <div id="myDropdown" class="dropdown-content"></div>
      </div>
    </div>

    <div class="bloco2">
      <div class="kpi_card">
        <span class="kpi_texto">Uso de CPU</span>
        <div class="chart_kpi">
          <canvas id="myChart1"></canvas>
        </div>
        <span class="kpi_texto_inferior" id="usoTotalCpu">%</span>
        <span class="kpi_texto_inferior2" id="usoAtual_Max_Cpu"><span id="usoAtualCpu">...</span>/<span
            id="usoMaxCpu">...</span></span>
      </div>

      <div class="kpi_card">
        <span class="kpi_texto">Uso de RAM</span>
        <div class="chart_kpi">
          <canvas id="myChart2"></canvas>
        </div>
        <span class="kpi_texto_inferior" id="usoTotalRam">%</span>
        <span class="kpi_texto_inferior2" id="usoAtual_Max_Ram"><span id="usoAtualRam">...</span>/<span
            id="usoMaxRam">...</span></span>
      </div>

      <div class="kpi_card">
        <span class="kpi_texto_disco">Espaço em disco utilizado</span>
        <div class="chart_kpi_disco">
          <canvas id="myChart3"></canvas>
        </div>
        <span class="kpi_texto_inferior_disco" id="usoTotalDisco">%</span>
        <span class="kpi_texto_inferior2_disco" id="usoAtual_Max_Disco"><span id="usoAtualDisco">...</span>/<span
            id="usoMaxDisco">...</span></span>
      </div>
    </div>

    <div class="bloco3">
      <p>Visão geral do uso de RAM</p>
      <div class="graph_treshoulds">
        <div class="area-button">
          <button onclick="download_graph_ram()">Exportar como PNG</button>
        </div>
        <canvas id="chartRam"></canvas>
        <div id="legenda1" class="legendas">
          <div class="item_legend">
            <div class="ideal"></div>
            <p style="font-size: 15px">Zona Ideal</p>
          </div>
          <div class="item_legend">
            <div class="atencao"></div>
            <p style="font-size: 15px">Zona de Atenção</p>
          </div>
          <div class="item_legend">
            <div class="critico"></div>
            <p style="font-size: 15px">Zona Crítica</p>
          </div>
        </div>
      </div>
    </div>

    <div class="bloco3">
      <p>Visão geral do uso de CPU</p>
      <div class="graph_treshoulds">
        <div class="area-button">
          <button onclick="download_graph_cpu()">Exportar como PNG</button>
        </div>
        <canvas id="chartCpu"></canvas>
        <div id="legenda2" class="legendas">
          <div class="item_legend">
            <div class="ideal"></div>
            <p style="font-size: 15px">Zona Ideal</p>
          </div>
          <div class="item_legend">
            <div class="atencao"></div>
            <p style="font-size: 15px">Zona de Atenção</p>
          </div>
          <span class="kpi_texto_inferior" id="usoTotalRam">%</span>
          <span class="kpi_texto_inferior2" id="usoAtual_Max_Ram"><span id="usoAtualRam">...</span>/<span
              id="usoMaxRam">...</span></span>
        </div>
      </div>
    </div>
    
      <div class="bloco3">
        <p>Visão geral do uso de DISCO</p>
        <div class="graph_treshoulds">
          <div class="area-button">
            <span id="horarioDeUtilizacaoDisco"></span>
            <button onclick="download_graph_disco()">Exportar como PNG</button>
          </div>
          <canvas id="chartDisco"></canvas>
          <div id="legenda3" class="legendas">
            <div class="item_legend">
              <div class="ideal"></div>
              <p style="font-size: 15px">Zona Ideal</p>
            </div>
            <div class="item_legend">
              <div class="atencao"></div>
              <p style="font-size: 15px">Zona de Atenção</p>
            </div>
            <div class="item_legend">
              <div class="critico"></div>
              <p style="font-size: 15px">Zona Crítica</p>
            </div>
          </div>
        </div>
      </div>

      <div class="bloco4">
        <p>Processos ativos no sistema</p>
        <input type="search" id="inputSearch" oninput="searchProcess()" placeholder="Procure um processo.." />
        <div class="lista_processos">
          <div id="painel" class="painel">
            <table id="tableProcess">
              <thead>
                <tr>
                  <th class="filterProcess">
                    <label for="">NOME</label><span id="title_nome" onclick="filterTablePerName(this)">▲</span>
                  </th>
                  <th class="filterProcess">
                    <label for="">CPU</label><span id="title_cpu" onclick="filterTablePerCpu(this)">▲</span>
                  </th>
                  <th class="filterProcess">
                    <label for="">MEMORIA</label><span id="title_memoria" onclick="filterTablePerMemoria(this)">▲</span>
                  </th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="tbody-process"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="./js/dashboard.js"></script>

    <script src="./js/sweetalert2.all.min.js"></script>
    <script src="./js/alertas_popup.js"></script>
    <script src="./js/dashboards_treshoulds.js"></script>

    <script src="./js/dynamicDash.js"></script>
</body>

</html>

<script>
  /* Setup KPI CPU (chart1)*/
  const labels1 = ["Mhz Utilizado", "Mhz Livre"];

  const data1 = {
    labels: labels1,
    datasets: [
      {
        label: "CPU",
        backgroundColor: ["#17EBE6", "#e0e0e0"],
        data: [],
      },
    ],
  };

  /* Setup KPI RAM (chart2)*/
  const labels2 = ["GBs Utilizado", "GBs Livre"];

  const data2 = {
    labels: labels2,
    datasets: [
      {
        label: "RAM",
        backgroundColor: ["#17EBE6", "#e0e0e0"],
        data: [],
      },
    ],
  };

  /* Setup KPI Disco (chart3)*/
  const labels3 = ["GBs Utilizado", "GBs Livre"];

  let data3 = {
    labels: labels3,
    datasets: [
      {
        backgroundColor: ["#17EBE6", "#e0e0e0"],
        data: [],
      },
    ],
  };

  /* Setup visão geral (chart4)*/
  const labels4 = [];

  const data4 = {
    labels: labels4,
    datasets: [
      {
        label: "CPU",
        borderColor: ["#009492"],
        backgroundColor: "rgba(0, 148, 146, 0.5)",
        data: [],
        fill: true,
      },

      {
        label: "RAM",
        borderColor: ["#17EBE6"],
        backgroundColor: "rgba(23, 235, 230, 0.5)",
        data: [],
        fill: true,
      },

      {
        label: "Disco",
        borderColor: ["#174366"],
        backgroundColor: "rgba(23, 67, 102, 0.5)",
        data: [],
        fill: true,
      },
    ],
  };

  /* config chart 1 (CPU)*/
  const config1 = {
    type: "doughnut",
    data: data1,
    options: {
      responsive: true,
      maintainAspectRatio: false,
      rotation: -90,
      circumference: 180,
      cutout: 55,
      plugins: {
        legend: {
          display: false,
        },
      },
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          },
        ],
      },
    },
  };

  /* config chart 2 (RAM)*/
  const config2 = {
    type: "doughnut",
    data: data2,
    options: {
      responsive: true,
      maintainAspectRatio: false,
      rotation: -90,
      circumference: 180,
      cutout: 55,
      plugins: {
        legend: {
          display: false,
        },
      },
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          },
        ],
      },
    },
  };

  /* config chart 3 (disco)*/
  let config3 = {
    type: "doughnut",
    data: data3,
    options: {
      responsive: true,
      maintainAspectRatio: false,
      circumference: 360,
      cutout: 55,
      plugins: {
        legend: {
          display: false,
        },
      },
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          },
        ],
      },
    },
  };

  /* config chart 4 (visão geral)*/
  const config4 = {
    type: "line",
    data: data4,
    options: {
      responsive: true,
      smooth: true,
      lineTension: 0.5,
      maintainAspectRatio: false,
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          },
        ],
      },
    },
  };

  window.onload = DescriptografiaJWT();

  window.onload = preenchimentoNome();
</script>